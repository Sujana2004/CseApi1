<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8"/>
		<title>Students</title>
		<style>
			
			body {
			  font-family: "Segoe UI", sans-serif;
			  margin: 0;
			  padding: 0;
			  min-height: 100vh;
			  background: url('/images/FJVVQn.gif') no-repeat center center fixed;
			  background-size: cover;
			  color: #fff;
			}

			
			h1 {
			  text-align: center;
			  padding: 1.2rem;
			  color: #ffffff;
			  letter-spacing: 2px;
			  text-shadow: 0 0 5px #00eaff, 0 0 10px #00eaff, 0 0 20px #00eaff;
			}

			
			table {
			  width: 90%;
			  margin: 1.5rem auto;
			  border-collapse: collapse;
			  border-radius: 10px;
			  overflow: hidden;
			  background: rgba(25, 25, 25, 0.9);
			  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.8);
			  backdrop-filter: blur(6px);
			}

			th, td {
			  padding: 14px;
			  text-align: left;
			  color: #fff;
			}

			thead tr {
			  background: linear-gradient(90deg, #0f2027, #203a43, #2c5364);
			  color: #00eaff;
			  font-weight: bold;
			  text-shadow: 0 0 6px #00eaff;
			}

			tbody tr:nth-child(even) {
			  background: rgba(255, 255, 255, 0.05);
			}

			tbody tr:hover {
			  background: rgba(0, 234, 255, 0.15);
			  transition: 0.3s ease;
			}

	
			input[type="text"], input[type="email"], input[type="number"] {
			  width: 95%;
			  padding: 8px;
			  background: #222;
			  border: 1px solid #444;
			  color: #fff;
			  border-radius: 6px;
			  box-shadow: inset 0 0 4px rgba(0, 234, 255, 0.6);
			  transition: all 0.3s ease;
			}

			input:focus {
			  outline: none;
			  border-color: #00eaff;
			  box-shadow: 0 0 6px #00eaff, 0 0 12px #00eaff;
			}

		
			button {
			  border: none;
			  border-radius: 6px;
			  padding: 8px 14px;
			  font-size: 0.95rem;
			  cursor: pointer;
			  color: #fff;
			  font-weight: 500;
			  text-transform: capitalize;
			  margin: 2px;
			  background: linear-gradient(145deg, #111, #333);
			  box-shadow: 0 0 8px rgba(0, 234, 255, 0.4);
			  transition: all 0.25s ease;
			}

			button:hover {
			  transform: translateY(-2px);
			  box-shadow: 0 0 12px rgba(0, 234, 255, 0.9), 0 0 24px rgba(0, 234, 255, 0.6);
			}

			#addBtn {
			  display: block;
			  margin: 1.2rem auto;
			  background: linear-gradient(135deg, #5a00a3, #9b00ff);
			  box-shadow: 0 0 10px rgba(155, 0, 255, 0.7);
			}
			#addBtn:hover {
			  background: linear-gradient(135deg, #00cba9, #007f6e);
			  box-shadow: 0 0 15px rgba(0, 255, 204, 0.9);
			}

		
			button[onclick*="startEdit"] {
			  background: linear-gradient(135deg, #f39c12, #e67e22);
			}
			button[onclick*="startEdit"]:hover {
			  background: linear-gradient(135deg, #e67e22, #d35400);
			}

			button[onclick*="deleteRow"] {
			  background: linear-gradient(135deg, #e74c3c, #c0392b);
			}
			button[onclick*="deleteRow"]:hover {
			  background: linear-gradient(135deg, #ff6b6b, #ff3c3c);
			}

			button[onclick*="saveEdit"], button[onclick*="saveNew"] {
			  background: linear-gradient(135deg, #27ae60, #2ecc71);
			}
			button[onclick*="saveEdit"]:hover, button[onclick*="saveNew"]:hover {
			  background: linear-gradient(135deg, #2ecc71, #00ff7f);
			}

			button[onclick*="cancelEdit"], button[onclick*="cancelNew"] {
			  background: linear-gradient(135deg, #7f8c8d, #95a5a6);
			}
			button[onclick*="cancelEdit"]:hover, button[onclick*="cancelNew"]:hover {
			  background: linear-gradient(135deg, #95a5a6, #bdc3c7);
			}


		</style>
	</head>
	<body>
		<h1>Students List</h1>
		<button id="addBtn">Add Student</button>
		<table id="studentsTable">
			<thead>
				<tr>
					<th>Student First Name</th>
					<th>Student Last Name</th>
					<th>Student Email</th>
					<th>Actions</th>
				</tr>
				<tbody>
					<tr th:each="std : ${students}" th:attr="data-id=${std.id}">
					<td th:text="${std.firstName}"></td>
					<td th:text="${std.lastName}"></td>
					<td th:text="${std.email}"></td>
					</tr>
				</tbody>
			</thead>
		</table>
		
		<script>
			
			const apiBase = "/students";
			
			document.getElementById('addBtn').addEventListener('click',addRow);
			
			function addRow(){
				const tbody = document.querySelector('#studentsTable tbody');
				const tr = document.createElement('tr');
				tr.innerHTML=`
				<td><input type="text" name="firstName" placeholder="First Name"/></td>
				<td><input type="text" name="lastName" placeholder="Last Name"/></td>
				<td><input type="text" name="email" placeholder="Email"/></td>
				<td>
					<button onclick="saveNew(this)">Save</button>
					<button onclick="cancelNew(this)">Cancel</button>
				</td>`;
				tbody.prepend(tr);
			}
			
			function rowToStudent(tr){
				const student = {};
				tr.querySelectorAll('input').forEach(i =>{
					student[i.name] = i.value;
				});
				return student;
			}
			
			function saveNew(btn){
				const tr = btn.closest('tr');
				const student = rowToStudent(tr);
				
				fetch(apiBase, {
					method: 'POST',
					headers: {'Content-Type':'application/json'},
					body: JSON.stringify(student)
				}).then(r=> r.json())
				.then(s => {
					tr.replaceWith(buildRow(s));
				}).catch(err => alert('Save Failed: '+err));
			}
			
			function cancelNew(btn){
				btn.closest('tr').remove();
			}
			
			function buildRow(s){
				const tr = document.createElement('tr');
				tr.setAttribute('data-id', s.id);
				tr.innerHTML = `
				<td>${s.firstName ?? ''}</td>
				<td>${s.lastName ?? ''}</td>
				<td>${s.email ?? ''}</td>
				<td>
					<button onclick="startEdit(this)">Update</button>
					<button onclick="deleteRow(this)">Delete</button>
				</td>`;
				return tr;
			}
			
			
			function rowToStudent(tr) {
			  return {
			    firstName: tr.querySelector('input[name="firstName"]').value,
			    lastName:  tr.querySelector('input[name="lastName"]').value,
			    email:     tr.querySelector('input[name="email"]').value
			  };
			}
			
			
		</script>
		
	</body>
</html>